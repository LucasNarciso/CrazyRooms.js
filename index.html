<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crazy Rooms</title>
    <link rel="stylesheet" href="GlobalStyle.css">
    <link rel="icon" href="Assets/Favicon.ico" />
    <meta name="Crazy Rooms" content="Um jogo onde você explora salas geradas de forma aleatória."/>
    <link rel="manifest" href="./manifest.json" />

    <script src="GlobalScript.js"></script>
    <!-- Teste de Botão de Download: -->
    <script>
        setTimeout(()=>{
            console.log("Iniciou script teste de Instalar PWA")
            if ('serviceWorker' in navigator && 'PushManager' in window) {
                console.log("Entrou no IF Personalizado")
                window.addEventListener('beforeinstallprompt', (e) => {
                    e.preventDefault();
        
                    const deferredPrompt = e;
        
                    const installButton = document.createElement('button');
                    installButton.textContent = 'Install App';
                    installButton.style.position = 'fixed';
                    installButton.style.top = '10px';
                    installButton.style.left = '50%';
                    installButton.style.transform = 'translateX(-50%)';
                    installButton.style.zIndex = '9999';
                    installButton.style.padding = '10px 20px';
                    installButton.classList.add('btn-grad');
                    installButton.style.color = 'white';
                    installButton.style.border = 'none';
                    installButton.style.borderRadius = '5px';
                    installButton.style.cursor = 'pointer';
        
                    installButton.addEventListener('click', () => {
        
                        deferredPrompt.prompt();
        
                        deferredPrompt.userChoice.then(choiceResult => {
                            if (choiceResult.outcome === 'accepted') {
                                console.log('App installed');
                            } else {
                                console.log('App installation declined');
                            }
        
                            installButton.style.display = 'none';
                        });
                    });
        
                    document.body.appendChild(installButton);
                });
            }else{
                console.log("-------Condições: ")
                console.log('serviceWorker')
                console.log(" IN ")
                console.log(navigator)
                console.log(" && ")
                console.log('PushManager')
                console.log(" IN ")
                console.log(window)
            }
        }, 1000)
    </script>
</head>
<body>
    <div class="conteiner" style="align-items: center; justify-content: center;">
        <button class="botaoCheio" onclick="goOn('ir','menu')">Versão Web</button>
        <button id="installApp">Instalar</button>
    </div>
</body>
</html>
